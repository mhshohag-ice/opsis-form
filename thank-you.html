<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Thank You - Opsis Vision Center</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f8ff;
      text-align: center;
      padding: 80px 20px;
      color: #333;
    }
    h1 {
      font-size: 2.5em;
      color: #00557f;
      margin-bottom: 20px;
    }
    p {
      font-size: 1.2em;
      margin-bottom: 40px;
    }
    .action-buttons { /* New container for the buttons */
        margin-top: 40px;
        text-align: center;
    }
    a.button, button.print-button {
      background-color: #00557f;
      color: white;
      padding: 12px 24px;
      text-decoration: none;
      border-radius: 5px;
      font-size: 16px;
      transition: background 0.3s ease;
      cursor: pointer;
      border: none;
      margin: 10px;
      display: inline-block;
    }
    a.button:hover, button.print-button:hover {
      background-color: #004261;
    }

    /* Styles for the print-friendly form clone - NOW VISIBLE BY DEFAULT */
    #printFormContainer {
      /* display: block; is implied if not hidden */
      max-width: 900px; /* Match your main form width */
      margin: 40px auto; /* Add margin to separate from other content */
      background: #fff;
      padding: 30px; /* Match your main form padding */
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: left; /* Ensure text alignment is good for the form */
    }

    #printFormContainer h2 {
      color: #00557f;
      margin-bottom: 10px;
      text-align: center; /* Center the form title */
    }
    #printFormContainer label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    #printFormContainer input[type="text"],
    #printFormContainer input[type="email"],
    #printFormContainer textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #f9f9f9; /* Make populated fields distinct */
      color: #333;
    }
    #printFormContainer .group {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }
    #printFormContainer .group input {
      flex: 1;
    }
    #printFormContainer table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      margin-bottom: 20px;
    }
    #printFormContainer th, #printFormContainer td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    #printFormContainer .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    #printFormContainer .checkbox-group label {
      font-weight: normal;
    }
    #printFormContainer .signature-section {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
    }
    #printFormContainer .signature-line {
      width: 45%;
      border-top: 1px solid #000;
      text-align: center;
      font-size: 14px;
      margin-top: 50px;
    }
    /* Hide submit buttons in the cloned form */
    #printFormContainer input[type="submit"] {
        display: none;
    }


    /* Styles specifically for printing */
    @media print {
      body {
        background-color: #fff;
        padding: 0;
        text-align: left;
      }
      /* Hide the main thank you message and buttons when printing */
      h1, p, .action-buttons { /* Use the new class for buttons */
        display: none;
      }
      /* Ensure the printFormContainer is always block when printing */
      #printFormContainer {
        display: block; /* Already block, but good to be explicit for print */
        box-shadow: none;
        border: none;
        padding: 10px;
        margin: 0;
        max-width: 100%;
      }
      /* Further print specific adjustments for inputs/textareas */
      #printFormContainer input[type="text"],
      #printFormContainer input[type="email"],
      #printFormContainer textarea {
          border: 1px dashed #999;
          background-color: transparent;
          padding: 3px;
      }
      #printFormContainer table {
          page-break-inside: auto;
      }
      #printFormContainer tr {
          page-break-inside: avoid;
          page-break-after: auto;
      }
    }
  </style>
</head>
<body>

  <div class="main-thank-you-section"> <!-- New div to group the intro message and buttons -->
      <h1>Thank You!</h1>
      <p>Your prescription form has been submitted successfully.</p>
  </div>

  <div id="printFormContainer">
    <h2>Spectacles Prescription Form (Submitted Details)</h2>

    <!-- This is a *duplicate* of your form's HTML from index.html -->
    <!-- We'll populate this with JS -->
    <form id="displayForm">
      <!-- NOTE: Remove 'action' and 'method' attributes from this display form -->
      <!-- Remove 'required' attributes as well, not needed for display -->

      <label for="name">1. Name:</label>
      <input type="text" name="Name" readonly> <!-- 'readonly' prevents user from editing -->

      <label for="email">2. Your Email:</label>
      <input type="email" name="email" readonly>

      <label for="complaint">3. Chief Complaint:</label>
      <textarea name="Chief Complaint" rows="3" readonly></textarea>

      <label for="history">4. History:</label>
      <textarea name="History" rows="3" readonly></textarea>

      <label>5. Visual Acuity:</label>
      <div class="group">
        <input type="text" name="Without PGP - R.E" placeholder="Without PGP - R.E" readonly>
        <input type="text" name="Without PGP - L.E" placeholder="Without PGP - L.E" readonly>
      </div>
      <div class="group">
        <input type="text" name="With PGP - R.E" placeholder="With PGP - R.E" readonly>
        <input type="text" name="With PGP - L.E" placeholder="With PGP - L.E" readonly>
      </div>

      <label>6. Final RX:</label>
      <table>
        <thead>
          <tr>
            <th></th><th>Sph</th><th>Cyl</th><th>Axis</th><th>ADD</th><th>Prism</th><th>Base</th><th>V/A</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>OD</td>
            <td><input type="text" name="OD_Sph" readonly></td>
            <td><input type="text" name="OD_Cyl" readonly></td>
            <td><input type="text" name="OD_Axis" readonly></td>
            <td><input type="text" name="OD_ADD" readonly></td>
            <td><input type="text" name="OD_Prism" readonly></td>
            <td><input type="text" name="OD_Base" readonly></td>
            <td><input type="text" name="OD_VA" readonly></td>
          </tr>
          <tr>
            <td>OS</td>
            <td><input type="text" name="OS_Sph" readonly></td>
            <td><input type="text" name="OS_Cyl" readonly></td>
            <td><input type="text" name="OS_Axis" readonly></td>
            <td><input type="text" name="OS_ADD" readonly></td>
            <td><input type="text" name="OS_Prism" readonly></td>
            <td><input type="text" name="OS_Base" readonly></td>
            <td><input type="text" name="OS_VA" readonly></td>
          </tr>
        </tbody>
      </table>

      <label for="frame">7. Frame:</label>
      <input type="text" name="Frame" readonly>

      <label for="lens_type">8. Lens Type:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="Lens Type[]" value="Single Vision" disabled> Single Vision</label>
        <label><input type="checkbox" name="Lens Type[]" value="Bifocal" disabled> Bifocal</label>
        <label><input type="checkbox" name="Lens Type[]" value="Progressive" disabled> Progressive</label>
      </div>

      <label for="lens_name">9. Lens Name:</label>
      <input type="text" name="Lens Name" readonly>

      <label for="lens_index">10. Lens Index:</label>
      <input type="text" name="Lens Index" readonly>

      <label for="lens_coating">11. Lens Coating:</label>
      <input type="text" name="Lens Coating" readonly>

      <label>12. Advice For:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="Advice[]" value="Constant Use" disabled> Constant Use</label>
        <label><input type="checkbox" name="Advice[]" value="Near Use" disabled> Near Use</label>
        <label><input type="checkbox" name="Advice[]" value="Distance Use" disabled> Distance Use</label>
        <label><input type="checkbox" name="Advice[]" value="Day" disabled> Day</label>
        <label><input type="checkbox" name="Advice[]" value="Night" disabled> Night</label>
      </div>

      <label>13. Confirmation:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="Confirm[]" value="OK with previous prescription" disabled> OK with my previous prescription</label>
        <label><input type="checkbox" name="Confirm[]" value="Agreed with new power" disabled> Agreed with new power prescribed</label>
      </div>

      <div class="signature-section">
        <div>
          <label>Optometrist Name:</label>
          <input type="text" name="Optometrist Name" readonly>
          <div class="signature-line">Optometrist Signature</div>
        </div>
        <div>
          <label>Customer Name:</label>
          <input type="text" name="Customer Name" readonly>
          <div class="signature-line">Customer Signature</div>
        </div>
      </div>

      <!-- Hide the original submit button in this cloned form -->
      <input type="submit" value="Submit Prescription" style="display: none;">

      <!-- Hidden Formsubmit settings (also hidden) -->
      <input type="hidden" name="_cc" value="">
      <input type="hidden" name="_next" value="">
      <input type="hidden" name="_captcha" value="">
    </form>
  </div>

  <div class="action-buttons"> <!-- Buttons are now in this container -->
      <button class="print-button" onclick="window.print()">Print Full Prescription to PDF</button>
      <a href="index.html" class="button">← Back to Home</a>
  </div>

  <!-- JavaScript to retrieve and display submission data -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const printFormContainer = document.getElementById('printFormContainer');
      const displayForm = document.getElementById('displayForm');
      const storedData = localStorage.getItem('lastPrescriptionSubmission');

      if (storedData) {
        const formData = JSON.parse(storedData);

        // Iterate through the cloned form's elements and populate them
        const inputs = displayForm.querySelectorAll('input, textarea, select');
        inputs.forEach(input => {
          if (input.name && formData[input.name] !== undefined) {
            const value = formData[input.name];

            if (input.type === 'checkbox') {
              // For checkboxes, value is an array if multiple were selected
              if (Array.isArray(value)) {
                input.checked = value.includes(input.value);
              } else { // Single checkbox
                input.checked = (value === input.value);
              }
            } else if (input.type === 'radio') {
              if (value === input.value) {
                input.checked = true;
              }
            } else {
              input.value = value;
            }
          }
        });

      } else {
        // If no data found, display a message within the container
        printFormContainer.innerHTML = '<h2>No Submission Data</h2><p>No submission data found or page refreshed. Please submit the form again to see your details here.</p>';
      }

      // Clear localStorage after displaying (optional, but good for privacy)
      localStorage.removeItem('lastPrescriptionSubmission');
    });
  </script>

</body>
</html>
