<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prescription Submitted - Opsis Vision Center</title>
<style>
  body {font-family: Arial, sans-serif; background: #f5f7fa; margin:0; padding:20px;}
  .container {max-width: 750px; margin:auto; background:#fff; padding:30px 40px; border:1px solid #ccc; border-radius:10px;}
  .logo {display:flex; justify-content:center; margin-bottom:-30px;}
  .logo img {width:120px; height:auto;}
  h2{text-align:center; color:#333; margin:5px 0;}
  label {font-weight:bold; display:block; margin-top:15px;}
  .group {display:flex; flex-wrap:wrap; gap:10px; margin-top:5px;}
  .group label {width:150px; font-weight: normal;}
  .value {flex:1; padding:5px; border:1px solid #bbb; border-radius:6px; background:#fff;}
  table {width:100%; border-collapse:collapse; margin-top:10px;}
  th, td {border:1px solid #ddd; text-align:center; padding:6px;}
  th {background:#f0f0f0;}
  .checkbox-group label {display:inline-block; margin-right:15px; font-weight: normal;}
  .checkbox-box {display:inline-block; width:18px; height:18px; border:1px solid #000; text-align:center; line-height:16px; margin-right:5px; vertical-align:middle;}
  .signature-section {display:flex; justify-content:space-between; margin-top:30px; gap:20px;}
  .signature-section div {width:48%;}
  .signature-line {border-top:1px solid #000; margin-top:30px; text-align:center; font-style:italic;}
  button {display:block; margin:30px auto 0; padding:10px 20px; font-size:16px; background:#007bff; color:#fff; border:none; border-radius:6px; cursor:pointer;}
  button:hover {background:#0056b3;}
  @media print {
    button {display:none;}
    body {margin:0; padding:0;}
    .container {border:none; box-shadow:none; border-radius:0; width:100%; max-width:100%; padding:0;}
  }
</style>
</head>
<body>
<div class="container">
  <div class="logo">
    <img src="logo.png" alt="Opsis Vision Center Logo">
  </div>
  <h2>Opsis Vision Center</h2>
  <p>Concord Sohel Square, G-A, 75 Satmasjid Road, Dhanmondi, Dhaka-1209</p>
 <h3>Prescription Form</h3>
 
  <div id="formDataDisplay">
    <!-- Form data will be injected here -->
  </div>

  <button onclick="window.print()">üñ®Ô∏è Print Prescription</button>
</div>

<script>
document.addEventListener('DOMContentLoaded', function(){
  const data = JSON.parse(localStorage.getItem('lastPrescriptionSubmission') || '{}');
  const container = document.getElementById('formDataDisplay');

  function createField(label, value){
    return `<label>${label}</label><div class="value">${value && value.trim() !== '' ? value : '--'}</div>`;
  }

  let html = '';

  html += createField('1. Name:', data['Name']);
  html += createField('2. Your Email:', data['email']);
  html += createField('3. Chief Complaint:', data['Chief Complaint']);
  html += createField('4. History:', data['History']);

  // Visual Acuity
  html += `<label>5. Visual Acuity:</label>`;
  html += `<div class="group"><label>Without PGP - R.E:</label><div class="value">${data['Without_PGP_RE'] || '--'}</div>`;
  html += `<label>Without PGP - L.E:</label><div class="value">${data['Without_PGP_LE'] || '--'}</div></div>`;
  html += `<div class="group"><label>With PGP - R.E:</label><div class="value">${data['With_PGP_RE'] || '--'}</div>`;
  html += `<label>With PGP - L.E:</label><div class="value">${data['With_PGP_LE'] || '--'}</div></div>`;

  // Final RX Table
  html += `<label>6. Final RX:</label>`;
  html += `<table>
    <thead><tr><th></th><th>Sph</th><th>Cyl</th><th>Axis</th><th>V/A</th></tr></thead>
    <tbody>
      <tr>
        <td>OD</td>
        <td>${data['OD_Sph']||'--'}</td>
        <td>${data['OD_Cyl']||'--'}</td>
        <td>${data['OD_Axis']||'--'}</td>
        <td>${data['OD_VA']||'--'}</td>
      </tr>
      <tr>
        <td>OS</td>
        <td>${data['OS_Sph']||'--'}</td>
        <td>${data['OS_Cyl']||'--'}</td>
        <td>${data['OS_Axis']||'--'}</td>
        <td>${data['OS_VA']||'--'}</td>
      </tr>
    </tbody>
  </table>`;

  html += createField('7. Frame:', data['Frame']);

  // Lens Type
  html += `<label>8. Lens Type:</label><div class="checkbox-group">`;
  ['Single Vision','Bifocal','Progressive'].forEach(v=>{
    const checked = data['Lens Type[]']?.includes(v) ? '‚úî' : '';
    html += `<label><span class="checkbox-box">${checked}</span>${v}</label>`;
  });
  html += `</div>`;

  html += createField('9. Lens Name:', data['Lens Name']);
  html += createField('10. Lens Index:', data['Lens Index']);
  html += createField('11. Lens Coating:', data['Lens Coating']);

  // Advice
  html += `<label>12. Advice For:</label><div class="checkbox-group">`;
  ['Constant Use','Near Use','Distance Use','Day','Night'].forEach(v=>{
    const checked = data['Advice[]']?.includes(v) ? '‚úî' : '';
    html += `<label><span class="checkbox-box">${checked}</span>${v}</label>`;
  });
  html += `</div>`;

  // Confirmation
  html += `<label>13. Confirmation:</label><div class="checkbox-group">`;
  ['OK with previous prescription','Agreed with new power prescribed'].forEach(v=>{
    const checked = data['Confirm[]']?.includes(v) ? '‚úî' : '';
    html += `<label><span class="checkbox-box">${checked}</span>${v}</label>`;
  });
  html += `</div>`;

  // Signatures
  html += `<div class="signature-section">
    <div>${createField('Optometrist Name:', data['Optometrist Name'])}<div class="signature-line">Optometrist Signature</div></div>
    <div>${createField('Customer Name:', data['Customer Name'])}<div class="signature-line">Customer Signature</div></div>
  </div>`;

  container.innerHTML = html;
});
</script>
</body>
</html>

